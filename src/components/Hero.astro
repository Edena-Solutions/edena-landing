---
import type { Translation } from "@/i18n";
import type { ImageMetadata } from "astro";

import { Card, CardHeader, CardContent, CardFooter } from "@/components/ui/card";
import { Image } from "astro:assets";
import BookDemoButton from "@/components/BookDemoButton.astro";

interface HeroCard {
    title: string;
    description: string;
    image?: ImageMetadata;
    imageClass?: string;
    showButton?: boolean;
    cardClass?: string;
    altText?: string;
    downloadAppButtons?: {
        androidUrl?: string;
        iosUrl?: string;
    };
}

interface Props {
    t: Translation;
    heroImage: ImageMetadata;
    mainTitle: string;
    mainDescription: string;
    showBookDemoInHero?: boolean;
    leftCard: HeroCard;
    rightCard: HeroCard;
    heroImageClass?: string;
    heroImageAspectRatio?: string;
}

const {
    t,
    heroImage,
    mainTitle,
    mainDescription,
    showBookDemoInHero = false,
    leftCard,
    rightCard,
    heroImageClass = "w-full mx-auto object-contain",
    heroImageAspectRatio = "16/9",
} = Astro.props;
---

<div class="grid gap-4">
    <Card
        className="flex flex-col items-center justify-start text-center h-90 sm:h-160 overflow-hidden bg-card gap-4"
    >
        <CardHeader>
            <h1 class="text-xl font-bold max-w-2xl">{mainTitle}</h1>
        </CardHeader>
        <CardContent className="flex flex-col gap-4 items-center pb-0">
            <p class="text-muted-foreground max-w-150">
                {mainDescription}
            </p>
        </CardContent>
        <CardFooter className="flex flex-col gap-4">
            {showBookDemoInHero && <BookDemoButton t={t} className="hidden sm:block" />}
            <Image
                src={heroImage}
                alt={t.altText.heroImage}
                loading="eager"
                class={heroImageClass}
                style={`aspect-ratio: ${heroImageAspectRatio};`}
            />
        </CardFooter>
    </Card>

    <div class="grid sm:grid-cols-2 gap-4 px-4">
        <Card
            className="flex rounded flex-col gap-4 items-center justify-center text-center bg-gradient-primary"
        >
            <CardHeader>
                <h2 class="text-xl font-bold max-w-100">{leftCard.title}</h2>
            </CardHeader>
            <CardContent className="flex flex-col gap-6 items-center pb-0">
                <p class="max-w-100">
                    {leftCard.description}
                </p>
            </CardContent>
            {
                leftCard.showButton && (
                    <CardFooter className="flex gap-4">
                        <BookDemoButton t={t} variant="white" />
                    </CardFooter>
                )
            }
        </Card>

        <Card
            className={`flex rounded flex-col items-center text-center overflow-hidden bg-card ${rightCard.cardClass || "h-80 md:h-110"} gap-4`}
        >
            {
                rightCard.title && (
                    <CardHeader className="pb-2">
                        <h2 class="text-xl font-bold">{rightCard.title}</h2>
                    </CardHeader>
                )
            }
            <CardContent
                className={`flex flex-col gap-4 items-center ${rightCard.image || rightCard.downloadAppButtons ? "pb-0" : ""}`}
            >
                <p class="text-muted-foreground max-w-100">
                    {rightCard.description}
                </p>
            </CardContent>
            {
                rightCard.downloadAppButtons ? (
                    <CardFooter className="flex flex-row gap-3 items-center w-full justify-center">
                        {rightCard.downloadAppButtons.iosUrl && (
                            <a
                                href={rightCard.downloadAppButtons.iosUrl}
                                target="_blank"
                                rel="noopener noreferrer"
                                class="inline-block"
                            >
                                <img
                                    src="https://tools.applemediaservices.com/api/badges/download-on-the-app-store/black/en-us?size=250x83&releaseDate=1288569600"
                                    alt={t.altText.appStoreBadge}
                                    class="h-9 w-auto"
                                />
                            </a>
                        )}
                        {rightCard.downloadAppButtons.androidUrl && (
                            <a
                                href={rightCard.downloadAppButtons.androidUrl}
                                target="_blank"
                                rel="noopener noreferrer"
                                class="inline-block"
                            >
                                <img
                                    src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/78/Google_Play_Store_badge_EN.svg/960px-Google_Play_Store_badge_EN.svg.png"
                                    alt={t.altText.googlePlayBadge}
                                    class="h-9 w-auto"
                                />
                            </a>
                        )}
                    </CardFooter>
                ) : (
                    rightCard.image && (
                        <CardFooter>
                            <Image
                                src={rightCard.image}
                                alt={rightCard.altText || rightCard.title || t.altText.heroImage}
                                loading="eager"
                                class={rightCard.imageClass || "w-full mx-auto object-contain"}
                            />
                        </CardFooter>
                    )
                )
            }
        </Card>
    </div>
</div>
